/* Generated by Opal 1.0.3 */
(function(Opal) {
  function $rb_gt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs > rhs : lhs['$>'](rhs);
  }
  function $rb_ge(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs >= rhs : lhs['$>='](rhs);
  }
  function $rb_plus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);
  }
  function $rb_lt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs < rhs : lhs['$<'](rhs);
  }
  function $rb_times(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs * rhs : lhs['$*'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $$$ = Opal.const_get_qualified, $$ = Opal.const_get_relative, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass, $truthy = Opal.truthy;

  Opal.add_stubs(['$setPrefixes', '$upcase', '$===', '$to_i', '$last_match', '$get_emancipation_table', '$get_personality_table', '$get_location_table', '$get_quiet_table', '$get_delight_table', '$get_trauma_table', '$get_scene_production_table', '$get_stance_table', '$get_emotion_table', '$>', '$roll', '$get_table_by_number', '$>=', '$+', '$get_Alter_raise_1d6_table_result', '$get_Alter_raise_d66_table_result', '$to_s', '$[]', '$<', '$*']);
  return (function($base, $super, $parent_nesting) {
    var self = $klass($base, $super, 'Alter_raise');

    var $nesting = [self].concat($parent_nesting), $Alter_raise_rollDiceCommand$1, $Alter_raise_get_emancipation_table$2, $Alter_raise_get_personality_table$3, $Alter_raise_get_location_table$4, $Alter_raise_get_quiet_table$5, $Alter_raise_get_delight_table$6, $Alter_raise_get_trauma_table$7, $Alter_raise_get_scene_production_table$8, $Alter_raise_get_stance_table$9, $Alter_raise_get_emotion_table$10, $Alter_raise_get_Alter_raise_1d6_table_result$11, $Alter_raise_get_Alter_raise_d66_table_result$12;

    
    Opal.const_set($nesting[0], 'ID', "Alter_raise");
    Opal.const_set($nesting[0], 'NAME', "\u5FC3\u885D\u60F3\u6A5FTRPG\u30A2\u30EB\u30C8\u30EC\u30A4\u30BA");
    Opal.const_set($nesting[0], 'SORT_KEY', "\u3042\u308B\u3068\u308C\u3044\u3059");
    Opal.const_set($nesting[0], 'HELP_MESSAGE', "" + "\u25C6\u89E3\u653E\u5224\u5B9A\uFF1AEMA[x]\n" + "\n" + "[x]\u3067\u9054\u6210\u5024\u3092\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002\u7701\u7565\u6642\u306F\u30C0\u30A4\u30B9\u30ED\u30FC\u30EB\u3057\u307E\u3059\u3002\n" + "\n" + "\n" + "\u3010\u5404\u7A2E\u8868\u3011\n" + "\u25C6\u6027\u683C\u50BE\u5411\u8868\uFF1APER[n]\u3000\u3000\u3000\u3000\u3000\u3000 \u25C6\u5834\u6240\u8868\uFF1ALOC[ab]\n" + "\u25C6\u5E73\u7A4F\u30FB\u7D4C\u9A13\u8868\uFF1AQUI[ab]\u3000\u3000\u3000\u3000\u3000\u25C6\u559C\u3073\u30FB\u7D4C\u9A13\u8868\uFF1ADEL[ab]\n" + "\u25C6\u5FC3\u306E\u50B7\u30FB\u7D4C\u9A13\u8868\uFF1ATRA[ab]\u3000\u3000\u3000\u3000\u25C6\u30B7\u30FC\u30F3\u6F14\u51FA\u8868\uFF1ASCE[n]\n" + "\u25C6\u30B9\u30BF\u30F3\u30B9\u8868\uFF1ASTA[n]\u3000\u3000\u3000\u3000\u3000\u3000 \u25C6\u611F\u60C5\u8868\uFF1AEMO[ab]\n" + "\n" + "[]\u5185\u306E\u30B3\u30DE\u30F3\u30C9\u3092\u7701\u7565\u3067\u30C0\u30A4\u30B9\u30ED\u30FC\u30EB\u3001\u6307\u5B9A\u3067ROC\u7D50\u679C\u3092\u8868\u793A\u3057\u307E\u3059\u3002\n" + "[n]\u306F\u300C1D6\u300D\u3001[ab]\u306F\u300CD66\u300D\u306E\u51FA\u76EE\u3092\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002\n" + "\n" + "\u3010\u66F8\u5F0F\u4F8B\u3011\n" + "PER3\uFF1A\u6027\u683C\u50BE\u5411\u8868\u306E\u300C3\u300D\u3092ROC\n" + "LOC52\uFF1A\u5834\u6240\u8868\u306E\u300C52\u300D\u3092ROC\n" + "QUI\uFF1A\u5E73\u7A4F\u30FB\u7D4C\u9A13\u8868\u3092\u30C0\u30A4\u30B9\u30ED\u30FC\u30EB\n");
    self.$setPrefixes(["EMA(\\d+)?", "PER(\\d+)?", "LOC(\\d+)?", "QUI(\\d+)?", "DEL(\\d+)?", "TRA(\\d+)?", "SCE(\\d+)?", "STA(\\d+)?", "EMO(\\d+)?"]);
    
    Opal.def(self, '$rollDiceCommand', $Alter_raise_rollDiceCommand$1 = function $$rollDiceCommand(command) {
      var $a, self = this, output = nil, $case = nil, roc = nil;

      
      output = (function() {$case = command.$upcase();
      if (/EMA(\d+)?$/i['$===']($case)) {
      roc = ($truthy($a = $$($nesting, 'Regexp').$last_match(1)) ? $a : 0).$to_i();
      return self.$get_emancipation_table(roc);}
      else if (/PER(\d+)?$/i['$===']($case)) {
      roc = ($truthy($a = $$($nesting, 'Regexp').$last_match(1)) ? $a : 0).$to_i();
      return self.$get_personality_table(roc);}
      else if (/LOC(\d+)?$/i['$===']($case)) {
      roc = ($truthy($a = $$($nesting, 'Regexp').$last_match(1)) ? $a : 0).$to_i();
      return self.$get_location_table(roc);}
      else if (/QUI(\d+)?$/i['$===']($case)) {
      roc = ($truthy($a = $$($nesting, 'Regexp').$last_match(1)) ? $a : 0).$to_i();
      return self.$get_quiet_table(roc);}
      else if (/DEL(\d+)?$/i['$===']($case)) {
      roc = ($truthy($a = $$($nesting, 'Regexp').$last_match(1)) ? $a : 0).$to_i();
      return self.$get_delight_table(roc);}
      else if (/TRA(\d+)?$/i['$===']($case)) {
      roc = ($truthy($a = $$($nesting, 'Regexp').$last_match(1)) ? $a : 0).$to_i();
      return self.$get_trauma_table(roc);}
      else if (/SCE(\d+)?$/i['$===']($case)) {
      roc = ($truthy($a = $$($nesting, 'Regexp').$last_match(1)) ? $a : 0).$to_i();
      return self.$get_scene_production_table(roc);}
      else if (/STA(\d+)?$/i['$===']($case)) {
      roc = ($truthy($a = $$($nesting, 'Regexp').$last_match(1)) ? $a : 0).$to_i();
      return self.$get_stance_table(roc);}
      else if (/EMO(\d+)?$/i['$===']($case)) {
      roc = ($truthy($a = $$($nesting, 'Regexp').$last_match(1)) ? $a : 0).$to_i();
      return self.$get_emotion_table(roc);}
      else { return nil }})();
      return output;
    }, $Alter_raise_rollDiceCommand$1.$$arity = 1);
    
    Opal.def(self, '$get_emancipation_table', $Alter_raise_get_emancipation_table$2 = function $$get_emancipation_table(roc) {
      var $a, $b, self = this, name = nil, table = nil, dice = nil, diceText = nil, tableText = nil;

      
      name = "\u89E3\u653E\u5224\u5B9A\u8868";
      table = [[2, "\u6FC0\u95D8\u3002\u4ECA\u56DE\u306E\u7AEF\u672B\u306F\u60F3\u5B9A\u3092\u306F\u308B\u304B\u306B\u4E0A\u56DE\u308B\u8105\u5A01\u3060\u3063\u305F\u3002\u5E7E\u672C\u3082\u306E\u592A\u5200\u7B4B\u3068\u6C38\u9060\u306E\u3088\u3046\u306A\u6642\u9593\u306E\u679C\u3066\u306B\u3001\u541B\u305F\u3061\u306F\u52DD\u5229\u3057\u305F\u3002\u6DF1\u624B\u3092\u8CA0\u3063\u305F\u304C\u3001\u30AE\u30EA\u30AE\u30EA\u81F4\u547D\u50B7\u3067\u306F\u306A\u3044\u3002"], [4, "\u8F9B\u52DD\u3002\u4ECA\u56DE\u306E\u7AEF\u672B\u306F\u60F3\u5B9A\u4EE5\u4E0A\u306E\u5927\u7269\u3060\u3063\u305F\u3002\u5203\u3068\u7259\u306E\u305B\u3081\u304E\u5408\u3044\u306E\u679C\u3066\u3001\u541B\u305F\u3061\u306F\u8F9B\u304F\u3082\u52DD\u5229\u3057\u305F\u3002"], [6, "\u52DD\u5229\u3002\u4ECA\u56DE\u306E\u7AEF\u672B\u306F\u3001\u304A\u304A\u3080\u306D\u60F3\u5B9A\u3055\u308C\u308B\u7A0B\u5EA6\u306E\u500B\u4F53\u3067\u3042\u3063\u305F\u3002\u591A\u5C11\u306E\u50B7\u306F\u8CA0\u3063\u305F\u304C\u3001\u541B\u305F\u3061\u306F\u554F\u984C\u306A\u304F\u52DD\u5229\u3067\u304D\u305F\u3002"], [8, "\u5FEB\u52DD\u3002\u4ECA\u56DE\u306E\u7AEF\u672B\u306B\u306F\u3001\u5371\u3046\u3052\u3082\u7121\u304F\u52DD\u5229\u3067\u304D\u305F\u3002\u541B\u3068\u30DA\u30A2\u306E\u30B3\u30F3\u30D3\u30CD\u30FC\u30B7\u30E7\u30F3\u306E\u8CDC\u7269\u3060\u308D\u3046\u3002\u304B\u3059\u308A\u50B7\u3092\u8CA0\u3063\u305F\u304C\u3001\u52F2\u7AE0\u306E\u3088\u3046\u306A\u3082\u306E\u3060\u3002"], [10, "\u5727\u52DD\u3002\u4ECA\u56DE\u306E\u7AEF\u672B\u306F\u3001\u541B\u305F\u3061\u306E\u6575\u3067\u306F\u306A\u304B\u3063\u305F\u3002\u541B\u3068\u30DA\u30A2\u306E\u5263\u6483\u306F\u77AC\u304F\u9593\u306B\u7AEF\u672B\u3092\u5BF8\u65AD\u3057\u3001\u7C92\u5B50\u306E\u5149\u306B\u9084\u5143\u3057\u305F\u3002"], [12, "\u5239\u90A3\u3002\u7AEF\u672B\u3092\u305D\u306E\u5207\u3063\u5148\u306B\u6349\u3048\u305F\u5239\u90A3\u3001\u541B\u305F\u3061\u306E\u524D\u3067\u7C92\u5B50\u306E\u5149\u304C\u821E\u3046\u3002\u305D\u308C\u4EE5\u4E0A\u4F55\u3082\u8D77\u3053\u308B\u3053\u3068\u306F\u306A\u304F\u3001\u4E16\u754C\u306F\u8272\u3092\u53D6\u308A\u623B\u3057\u305F\u3002"]];
      if ($truthy($rb_gt(roc, 1))) {
        
        dice = roc;
        if ($truthy($rb_gt(dice, 12))) {
          dice = 12};
        diceText = "";
      } else {
        
        $b = self.$roll(2, 6), $a = Opal.to_ary($b), (dice = ($a[0] == null ? nil : $a[0])), (diceText = ($a[1] == null ? nil : $a[1])), $b;
        diceText = "" + "(" + (diceText) + ")";
      };
      tableText = self.$get_table_by_number(dice, table);
      if ($truthy($rb_ge(dice, 7))) {
        tableText = $rb_plus(tableText, "\n\u3010\u9054\u6210\u50247\u4EE5\u4E0A\u3011GM\uFF1A\u653B\u6483\u30EB\u30FC\u30C1\u30F31\u3064\u3092\u958B\u793A\uFF08\u756A\u53F7\u306F\u30DA\u30A2PL\u304C\u6307\u5B9A\uFF09\u3000PL\uFF1A\u6226\u95D8\u958B\u59CB\u6642\u306E\u30A2\u30AF\u30BB\u30EB\u30EC\u30D9\u30EB+1")};
      return "" + (name) + " \uFF1E " + (dice) + (diceText) + "\uFF1A" + (tableText);
    }, $Alter_raise_get_emancipation_table$2.$$arity = 1);
    
    Opal.def(self, '$get_personality_table', $Alter_raise_get_personality_table$3 = function $$get_personality_table(roc) {
      var self = this, name = nil, table = nil;

      
      name = "\u6027\u683C\u50BE\u5411\u8868";
      table = [[1, "\u6311\u6226"], [2, "\u8ABF\u548C"], [3, "\u611F\u6027"], [4, "\u4FE1\u5FF5"], [5, "\u8AD6\u7406"], [6, "\u601D\u616E"]];
      return self.$get_Alter_raise_1d6_table_result(name, table, roc);
    }, $Alter_raise_get_personality_table$3.$$arity = 1);
    
    Opal.def(self, '$get_location_table', $Alter_raise_get_location_table$4 = function $$get_location_table(roc) {
      var self = this, name = nil, table = nil;

      
      name = "\u5834\u6240\u8868";
      table = [[13, "\u6559\u5BA4"], [16, "\u90E8\u5BA4"], [23, "\u5546\u5E97\u8857"], [26, "\u7530\u820E"], [33, "\u90FD\u4F1A"], [36, "\u99C5"], [43, "\u30D0\u30A4\u30C8"], [46, "\u30B9\u30C6\u30FC\u30B8"], [53, "\u56F3\u66F8\u9928"], [56, "\u75C5\u9662"], [63, "\u81EA\u7136"], [66, "\u5BB6"]];
      return self.$get_Alter_raise_d66_table_result(name, table, roc);
    }, $Alter_raise_get_location_table$4.$$arity = 1);
    
    Opal.def(self, '$get_quiet_table', $Alter_raise_get_quiet_table$5 = function $$get_quiet_table(roc) {
      var self = this, name = nil, table = nil;

      
      name = "\u5E73\u7A4F\u30FB\u7D4C\u9A13\u8868";
      table = [[13, "\u53CB\u9054"], [16, "\u5E7C\u99B4\u67D3\u307F"], [23, "\u4E21\u89AA"], [26, "\u5144\u5F1F"], [33, "\u89AA\u621A"], [36, "\u7406\u89E3\u8005"], [43, "\u53CB\u4EBA"], [46, "\u4EF2\u9593"], [53, "\u8DA3\u5473"], [56, "\u7DF4\u7FD2"], [63, "\u4E00\u4EBA"], [66, "\u304A\u6C17\u306B\u5165\u308A"]];
      return self.$get_Alter_raise_d66_table_result(name, table, roc);
    }, $Alter_raise_get_quiet_table$5.$$arity = 1);
    
    Opal.def(self, '$get_delight_table', $Alter_raise_get_delight_table$6 = function $$get_delight_table(roc) {
      var self = this, name = nil, table = nil;

      
      name = "\u559C\u3073\u30FB\u7D4C\u9A13\u8868";
      table = [[13, "\u52DD\u5229"], [16, "\u512A\u52DD"], [23, "\u51FA\u4F1A\u3044"], [26, "\u7406\u89E3"], [33, "\u5E78\u904B"], [36, "\u30D7\u30EC\u30BC\u30F3\u30C8"], [43, "\u6210\u5C31"], [46, "\u6210\u9577"], [53, "\u5275\u9020"], [56, "\u597D\u8EE2"], [63, "\u8A3C\u660E"], [66, "\u751F\u9084"]];
      return self.$get_Alter_raise_d66_table_result(name, table, roc);
    }, $Alter_raise_get_delight_table$6.$$arity = 1);
    
    Opal.def(self, '$get_trauma_table', $Alter_raise_get_trauma_table$7 = function $$get_trauma_table(roc) {
      var self = this, name = nil, table = nil;

      
      name = "\u5FC3\u306E\u50B7\u30FB\u7D4C\u9A13\u8868";
      table = [[13, "\u6557\u5317"], [16, "\u4EF2\u9055\u3044"], [23, "\u5931\u604B"], [26, "\u7121\u7406\u89E3"], [33, "\u7121\u529B"], [36, "\u5B64\u72EC"], [43, "\u5225\u96E2"], [46, "\u6B7B\u5225"], [53, "\u640D\u58CA"], [56, "\u55AA\u5931"], [63, "\u75C5"], [66, "\u4E8B\u6545"]];
      return self.$get_Alter_raise_d66_table_result(name, table, roc);
    }, $Alter_raise_get_trauma_table$7.$$arity = 1);
    
    Opal.def(self, '$get_scene_production_table', $Alter_raise_get_scene_production_table$8 = function $$get_scene_production_table(roc) {
      var self = this, name = nil, table = nil;

      
      name = "\u30B7\u30FC\u30F3\u6F14\u51FA\u8868";
      table = [[1, "\u76F8\u8AC7\u3002\u541B\u306F\u76F8\u624B\u306B\u76F8\u8AC7\u3057\u305F\u3044\u3053\u3068\u304C\u3042\u3063\u305F\u3002"], [2, "\u904A\u3073\u3002\u541B\u306F\u76F8\u624B\u3068\u904A\u3073\u305F\u304B\u3063\u305F\u3002"], [3, "\u6848\u5185\u3002\u541B\u306F\u81EA\u8EAB\u306E\u30A2\u30EA\u30A6\u30B9\u30FB\u30D1\u30FC\u30BD\u30CA\u30EB\u3092\u6848\u5185\u3057\u305F\u304B\u3063\u305F\u3002"], [4, "\u52DD\u8CA0\u3002\u541B\u306F\u76F8\u624B\u3068\u4F55\u3089\u304B\u306E\u52DD\u8CA0\u3092\u3057\u305F\u304B\u3063\u305F\u3002"], [5, "\u304A\u9858\u3044\u3002\u541B\u306F\u76F8\u624B\u306B\u304A\u9858\u3044\u3057\u305F\u3044\u3053\u3068\u304C\u3042\u3063\u305F\u3002"], [6, "\u6249\u3092\u958B\u304F\u524D\u306B\u3002\u30A2\u30AF\u30BB\u30EB\u30C0\u30A4\u30D6\u30FB\u30B2\u30FC\u30C8\u3092\u304F\u3050\u308B\u524D\u306B\u3001\u541B\u306F\u76F8\u624B\u306B\u8A71\u3057\u305F\u3044\u3053\u3068\u304C\u3042\u3063\u305F\u3002\uFF08\uFF0A\u30C0\u30A4\u30D6\u3057\u305F\u5F8C\u306E\u30B7\u30FC\u30F3\u3082\u6F14\u51FA\u3059\u308B\u3053\u3068\uFF09"]];
      return self.$get_Alter_raise_1d6_table_result(name, table, roc);
    }, $Alter_raise_get_scene_production_table$8.$$arity = 1);
    
    Opal.def(self, '$get_stance_table', $Alter_raise_get_stance_table$9 = function $$get_stance_table(roc) {
      var self = this, name = nil, table = nil;

      
      name = "\u30B9\u30BF\u30F3\u30B9\u8868";
      table = [[1, "\u53CB\u4EBA"], [2, "\u604B\u611B"], [3, "\u5E2B\u4E8B"], [4, "\u30E9\u30A4\u30D0\u30EB"], [5, "\u5BB6\u65CF"], [6, "\u5B88\u8B77"]];
      return self.$get_Alter_raise_1d6_table_result(name, table, roc);
    }, $Alter_raise_get_stance_table$9.$$arity = 1);
    
    Opal.def(self, '$get_emotion_table', $Alter_raise_get_emotion_table$10 = function $$get_emotion_table(roc) {
      var self = this, name = nil, table = nil;

      
      name = "\u611F\u60C5\u8868";
      table = [[13, "\u52C7\u6C17"], [16, "\u6012\u308A"], [23, "\u60B2\u3057\u307F"], [26, "\u559C\u3073"], [33, "\u9A5A\u304D"], [36, "\u6050\u308C"], [43, "\u5B89\u3089\u304E"], [46, "\u8AA0\u610F"], [53, "\u5E87\u8B77"], [56, "\u8B1D\u610F"], [63, "\u4FE1\u983C"], [66, "\u597D\u610F"]];
      return self.$get_Alter_raise_d66_table_result(name, table, roc);
    }, $Alter_raise_get_emotion_table$10.$$arity = 1);
    
    Opal.def(self, '$get_Alter_raise_1d6_table_result', $Alter_raise_get_Alter_raise_1d6_table_result$11 = function $$get_Alter_raise_1d6_table_result(name, table, roc) {
      var $a, $b, self = this, dice = nil, tableText = nil;

      
      if ($truthy($rb_gt(roc, 0))) {
        
        dice = roc;
        if ($truthy($rb_gt(dice, 6))) {
          dice = 6};
      } else {
        $b = self.$roll(1, 6), $a = Opal.to_ary($b), (dice = ($a[0] == null ? nil : $a[0])), $b
      };
      tableText = self.$get_table_by_number(dice, table);
      return "" + (name) + " \uFF1E " + (dice) + "\uFF1A" + (tableText);
    }, $Alter_raise_get_Alter_raise_1d6_table_result$11.$$arity = 3);
    return (Opal.def(self, '$get_Alter_raise_d66_table_result', $Alter_raise_get_Alter_raise_d66_table_result$12 = function $$get_Alter_raise_d66_table_result(name, table, roc) {
      var $a, $b, self = this, diceText = nil, dice1 = nil, dice2 = nil, dice = nil, tableText = nil;

      
      if ($truthy($rb_gt(roc, 10))) {
        
        diceText = roc.$to_s();
        dice1 = diceText['$[]'](0, 1).$to_i();
        if ($truthy($rb_gt(dice1, 6))) {
          dice1 = 6};
        dice2 = diceText['$[]'](1, 1).$to_i();
        if ($truthy($rb_lt(dice2, 1))) {
          dice2 = 1};
        if ($truthy($rb_gt(dice2, 6))) {
          dice2 = 6};
      } else if ($truthy($rb_gt(roc, 0))) {
        
        dice1 = roc;
        if ($truthy($rb_gt(dice1, 6))) {
          dice1 = 6};
        $b = self.$roll(1, 6), $a = Opal.to_ary($b), (dice2 = ($a[0] == null ? nil : $a[0])), $b;
      } else {
        
        $b = self.$roll(1, 6), $a = Opal.to_ary($b), (dice1 = ($a[0] == null ? nil : $a[0])), $b;
        $b = self.$roll(1, 6), $a = Opal.to_ary($b), (dice2 = ($a[0] == null ? nil : $a[0])), $b;
      };
      dice = $rb_plus($rb_times(dice1, 10), dice2);
      diceText = "" + (dice1) + "," + (dice2);
      tableText = self.$get_table_by_number(dice, table);
      return "" + (name) + " \uFF1E " + (diceText) + "\uFF1A" + (tableText);
    }, $Alter_raise_get_Alter_raise_d66_table_result$12.$$arity = 3), nil) && 'get_Alter_raise_d66_table_result';
  })($nesting[0], $$($nesting, 'DiceBot'), $nesting)
})(Opal);
